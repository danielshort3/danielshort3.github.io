/* Project card components */
/* ───────────────────────────────────────────────────────────
   8.  PROJECT CARDS
   ─────────────────────────────────────────────────────────── */
@layer components {
  @keyframes rippleFade{
    0%{opacity:0;transform:translateY(12px) scale(.98);}
    100%{opacity:1;transform:none;}
  }

  .project-card{
    position:relative;border-radius:14px;overflow:hidden;cursor:pointer;
    opacity:0;transition:opacity .35s cubic-bezier(.22,.61,.36,1),
    transform .35s cubic-bezier(.22,.61,.36,1),box-shadow .35s cubic-bezier(.22,.61,.36,1)
  }
  .project-card.ripple-in{animation:rippleFade .55s cubic-bezier(.2,.7,.3,1) forwards;transform:none}
  /* base media sizing (cover the frame, preserve aspect; align to top) */
  .project-card img{position:relative;z-index:0;width:100%;display:block;object-fit:cover;object-position:top;background:transparent}
  .project-card video{position:relative;z-index:0;width:100%;object-fit:cover;object-position:top;background:transparent}
  /* keep GIF replacement <video> hidden until JS confirms it can play */
  .gif-video{display:none}
  .project-card .gif-video{display:none}
  .project-card .overlay{position:absolute;inset:0;z-index:1;background:linear-gradient(180deg,rgba(0,0,0,.35)0%,rgba(0,0,0,.95)100%)}
  /* Stack title and subtitle in a single block to avoid overlap on wrap */
  .project-card .project-text{position:absolute;left:18px;right:18px;bottom:18px;display:flex;flex-direction:column;gap:4px;z-index:2;transform:translateZ(0);-webkit-transform:translateZ(0);backface-visibility:hidden;will-change:transform}
  .project-card .project-title{position:static;font-family:'Poppins';font-weight:600;font-size:20px;margin:0}
  .project-card .project-subtitle{position:static;font-size:14px;color:var(--text-muted);margin:0;
    display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}
  .project-card::before{
    content:"";position:absolute;inset:0;border:2px solid transparent;border-radius:14px;
    pointer-events:none;transition:border-color .35s cubic-bezier(.22,.61,.36,1)
  }
  .project-card:hover{
    transform:translateY(-8px) scale(1.04);
    box-shadow:0 14px 34px color-mix(in srgb, var(--primary) 32%, transparent),0 6px 20px rgba(0,0,0,.55)
  }
  .project-card:hover::before{border-color:var(--primary)}
  #projects.grid{
    display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
    gap:28px;padding:24px;
    max-width: var(--container-max);
    margin-inline: auto;
    align-content:start;
    transition:height .45s cubic-bezier(.22,.61,.36,1),
               padding .45s cubic-bezier(.22,.61,.36,1),
               opacity .35s ease;
    will-change:height,padding,opacity
  }
  #projects.grid-fade{opacity:0 !important}
  #projects.grid-hidden{visibility:hidden}
  .project-metric{
    position:absolute;top:18px;left:18px;
    background:color-mix(in srgb,var(--primary) 15%,transparent);color:var(--primary);
    font-size:.75rem;font-weight:600;padding:4px 10px;border-radius:6px;max-width:75%;pointer-events:none
  }

  /* Square frame, cover fill, top-aligned; no empty space, no distortion */
  .project-card img,
  .project-card video {
    width: 100%;
    height: auto;
    aspect-ratio: var(--project-card-aspect, 1 / 1);
    display: block;
    object-fit: cover;     /* fill without black bars, preserve aspect */
    object-position: top;  /* align with top of card frame */
    background: transparent;
  }
  /* --- Button-card reset to match previous DIV cards --- */
  button.project-card {
    border: 0;
    background: transparent;
    padding: 0;
    font: inherit;
    color: inherit;
    display: block;
    text-align: left;
    cursor: pointer;
  }

  /* Ensure titles/subtitles stay light & left-aligned */
  .project-card,
  .project-card .project-title,
  .project-card .project-subtitle,
  .carousel-card .project-title,
  .carousel-card .project-subtitle {
    color: var(--text-light);
    text-align: left;
  }

  /* Overlay should not block clicks */
  .project-card .overlay { pointer-events: none; }

  /* Focus visibility for keyboard users */
  .project-card:focus-visible {
    outline: 2px solid var(--primary);
    outline-offset: 2px;
  }

  /* Filter controls */
  #filter-menu{
    display:flex;
    justify-content:center;
    flex-wrap:wrap;
    gap:12px;
    max-width:var(--container-max);
    margin-inline:auto;
    margin-top:16px;
  }
  #filter-menu button{
    flex:0 0 auto;
    min-width:150px;
  }
  .filter-more-btn{
    display:inline-flex;
    align-items:center;
    gap:10px;
    border-radius:999px;
    border:1px solid color-mix(in srgb,var(--primary) 22%, transparent);
    padding:10px 18px;
    background:color-mix(in srgb,var(--surface) 92%, #03060b 8%);
    box-shadow:0 12px 26px rgba(0,0,0,.22);
    color:var(--text-light);
    font-weight:600;
    transition:transform .2s ease, border-color .2s ease, color .2s ease;
  }
  .filter-more-btn:hover,
  .filter-more-btn:focus-visible{
    border-color:color-mix(in srgb,var(--primary) 40%, transparent);
    transform:translateY(-1px);
    color:color-mix(in srgb,var(--text-light) 95%, #fff 5%);
  }
  .filter-more-count{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    min-width:28px;
    height:28px;
    border-radius:999px;
    font-size:.85rem;
    font-weight:600;
    background:color-mix(in srgb,var(--primary) 20%, transparent);
    color:var(--primary);
    padding:0 10px;
  }
  .filter-drawer-overlay{
    position:fixed;
    inset:0;
    background:color-mix(in srgb,var(--surface) 80%, transparent);
    backdrop-filter:blur(4px);
    opacity:0;
    pointer-events:none;
    transition:opacity .3s ease;
    z-index:1900;
  }
  .filter-drawer-overlay.is-visible{
    opacity:1;
    pointer-events:auto;
  }
  .filter-drawer{
    position:fixed;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    opacity:0;
    pointer-events:none;
    transition:opacity .3s ease;
    z-index:1950;
  }
  .filter-drawer.is-visible{
    opacity:1;
    pointer-events:auto;
  }
  .filter-drawer-content{
    width:min(640px, calc(100vw - 48px));
    max-height:82vh;
    overflow:auto;
    border-radius:24px;
    background:var(--surface);
    border:1px solid color-mix(in srgb,var(--primary) 22%, transparent);
    box-shadow:0 32px 64px rgba(0,0,0,.45);
    padding:28px clamp(20px,4vw,32px) 32px;
  }
  .filter-drawer-header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
    margin-bottom:8px;
  }
  .filter-drawer-title{
    margin:0;
    font-size:1.4rem;
    font-family:'Poppins',sans-serif;
    letter-spacing:.02em;
  }
  .filter-drawer-close{
    border:none;
    background:transparent;
    color:var(--text-muted);
    font-size:1.8rem;
    line-height:1;
    width:44px;
    height:44px;
    border-radius:50%;
    cursor:pointer;
    transition:color .2s ease, transform .2s ease;
  }
  .filter-drawer-close:hover,
  .filter-drawer-close:focus-visible{
    color:var(--primary);
    transform:translateY(-1px);
  }
  .filter-drawer-subtitle{
    margin:0 0 18px;
    color:var(--text-muted);
    font-size:.95rem;
  }
  .filter-drawer-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill, minmax(150px, 1fr));
    gap:12px;
  }
  body.filter-drawer-open{
    overflow:hidden;
  }
  @media (max-width:768px){
    #filter-menu{
      flex-direction:column;
      align-items:stretch;
      max-width:90%;
    }
    #filter-menu button{
      width:100%;
    }
    .filter-drawer-content{
      width:min(560px, calc(100vw - 24px));
      border-radius:20px;
    }
    .filter-drawer-grid{
      grid-template-columns:repeat(auto-fill, minmax(130px, 1fr));
    }
  }

  /* ── No-JS fallbacks ───────────────────────────────────────────── */
  html.no-js #projects.hide {
    display: grid !important;
    opacity: 1;
    visibility: visible;
  }
  html.no-js #filters.hide,
  html.no-js #carousel-gap.hide {
    display: block !important;
    opacity: 1;
    visibility: visible;
  }
  html.no-js #see-more {
    display: none;
  }
  html.no-js #portfolio-carousel .carousel-track {
    flex-direction: column;
    gap: 18px;
    transform: none !important;
  }
  html.no-js #portfolio-carousel .carousel-card {
    max-width: 100%;
    flex: 1 1 auto;
    opacity: 1;
    transform: none;
  }
  html.no-js #portfolio-carousel .carousel-dots {
    display: none;
  }
}
