/* Project card components */
/* ───────────────────────────────────────────────────────────
   8.  PROJECT CARDS
   ─────────────────────────────────────────────────────────── */
@layer components {
  @keyframes rippleFade{
    0%{opacity:0;transform:translateY(12px) scale(.98);}
    100%{opacity:1;transform:none;}
  }

  .project-card{
    position:relative;border-radius:var(--card-radius, 14px);overflow:hidden;cursor:pointer;
    opacity:0;transition:opacity .35s cubic-bezier(.22,.61,.36,1),
    transform .35s cubic-bezier(.22,.61,.36,1),box-shadow .35s cubic-bezier(.22,.61,.36,1)
  }
  .project-card.ripple-in{animation:rippleFade .55s cubic-bezier(.2,.7,.3,1) forwards;transform:none}
  /* base media sizing (cover the frame, preserve aspect; align to top) */
  .project-card img{position:relative;z-index:0;width:100%;display:block;object-fit:cover;object-position:top;background:transparent}
  .project-card video{position:relative;z-index:0;width:100%;object-fit:cover;object-position:top;background:transparent}
  /* keep GIF replacement <video> hidden until JS confirms it can play */
  .gif-video{display:none}
  .project-card .gif-video{display:none}
  .project-card .overlay{position:absolute;inset:0;z-index:1;background:linear-gradient(180deg,rgba(0,0,0,.35)0%,rgba(0,0,0,.95)100%)}
  /* Stack title and subtitle in a single block to avoid overlap on wrap */
  .project-card .project-text{position:absolute;left:18px;right:18px;bottom:18px;display:flex;flex-direction:column;gap:4px;z-index:2;transform:translateZ(0);-webkit-transform:translateZ(0);backface-visibility:hidden;will-change:transform}
  .project-card .project-title{position:static;font-family:'Poppins';font-weight:600;font-size:20px;margin:0}
  .project-card .project-subtitle{position:static;font-size:14px;color:var(--text-muted);margin:0;
    display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}
  .project-card::before{
    content:"";position:absolute;inset:0;border:2px solid transparent;border-radius:inherit;
    pointer-events:none;transition:border-color .35s cubic-bezier(.22,.61,.36,1)
  }
  .project-card:hover{
    transform:translateY(-4px) scale(1.02);
    box-shadow:var(--card-shadow),0 6px 20px rgba(0,0,0,.4)
  }
  .project-card:hover::before{border-color:var(--primary)}
  #projects.grid{
    display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
    gap:28px;padding:24px;
    max-width: var(--container-max);
    margin-inline: auto;
    align-content:start;
    transition:height .45s cubic-bezier(.22,.61,.36,1),
               padding .45s cubic-bezier(.22,.61,.36,1),
               opacity .35s ease;
    will-change:height,padding,opacity
  }
  #projects.grid-fade{opacity:0 !important}
  #projects.grid-hidden{visibility:hidden}
  .project-metric{
    position:absolute;top:18px;left:18px;
    background:color-mix(in srgb,var(--primary) 15%,transparent);color:var(--primary);
    font-size:.75rem;font-weight:600;padding:4px 10px;border-radius:6px;max-width:75%;pointer-events:none
  }

  /* Square frame, cover fill, top-aligned; no empty space, no distortion */
  .project-card img,
  .project-card video {
    width: 100%;
    height: auto;
    aspect-ratio: var(--project-card-aspect, 1 / 1);
    display: block;
    object-fit: cover;     /* fill without black bars, preserve aspect */
    object-position: top;  /* align with top of card frame */
    background: transparent;
  }
  /* --- Button-card reset to match previous DIV cards --- */
  button.project-card {
    border: 0;
    background: transparent;
    padding: 0;
    font: inherit;
    color: inherit;
    display: block;
    text-align: left;
    cursor: pointer;
  }

  /* Ensure titles/subtitles stay light & left-aligned */
  .project-card,
  .project-card .project-title,
  .project-card .project-subtitle,
  .carousel-card .project-title,
  .carousel-card .project-subtitle {
    color: var(--text-light);
    text-align: left;
  }

  /* Overlay should not block clicks */
  .project-card .overlay { pointer-events: none; }

  /* Focus visibility for keyboard users */
  .project-card:focus-visible {
    outline: 2px solid var(--primary);
    outline-offset: 2px;
  }

  /* Filter controls */
  .filter-menu{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
    gap:20px;
    max-width:var(--container-max);
    margin-inline:auto;
    margin-top:16px;
  }
  .filter-panel{
    border-radius:var(--card-radius-lg, 18px);
    border:1px solid color-mix(in srgb,var(--border-subtle) 72%, transparent);
    background:color-mix(in srgb,var(--surface) 94%, #03060d 6%);
    box-shadow:var(--card-shadow-soft);
    padding:clamp(20px, 3vw, 30px);
    display:flex;
    flex-direction:column;
    gap:14px;
  }
  .filter-panel-head h3{
    margin:.2rem 0;
    font-size:1.3rem;
  }
  .filter-panel-eyebrow{
    margin:0;
    text-transform:uppercase;
    letter-spacing:.2em;
    font-size:.72rem;
    color:color-mix(in srgb,var(--text-muted) 88%, #fff 12%);
  }
  .filter-panel-copy{
    margin:0;
    color:var(--text-muted);
    font-size:.95rem;
  }
  .filter-chip-row{
    display:grid;
    grid-template-columns:repeat(2,minmax(0,1fr));
    gap:12px;
  }
  .filter-chip-row button{
    width:100%;
  }
  .filter-chip-row .filter-chip-all{
    grid-column:1 / -1;
  }
  .filter-chip-row button.filter-chip-disabled{
    opacity:.45;
  }
  .filter-chip-row button:disabled{
    cursor:not-allowed;
  }
  @media (max-width:640px){
    .filter-chip-row{
      grid-template-columns:1fr;
      justify-items:stretch;
    }
    .filter-chip-row button{
      max-width:none;
    }
  }

  /* ── No-JS fallbacks ───────────────────────────────────────────── */
  html.no-js #projects.hide {
    display: grid !important;
    opacity: 1;
    visibility: visible;
  }
  html.no-js #filters.hide,
  html.no-js #carousel-gap.hide {
    display: block !important;
    opacity: 1;
    visibility: visible;
  }
  html.no-js #see-more {
    display: none;
  }
  html.no-js #portfolio-carousel .carousel-track {
    flex-direction: column;
    gap: 18px;
    transform: none !important;
  }
  html.no-js #portfolio-carousel .carousel-card {
    max-width: 100%;
    flex: 1 1 auto;
    opacity: 1;
    transform: none;
  }
  html.no-js #portfolio-carousel .carousel-dots {
    display: none;
  }
}
